## 資料夾架構

```json
nail-test/
├── /pages/
│   ├── index.js           // 美甲前台（客戶預約頁面）
│   ├── dashboard.js       // 美甲後台（管理頁面）
│   ├── /api/
│   │   ├── appointments.js // 後端 API（處理預約資料）
│   │   └── webhook.js     // LINE Bot Webhook（接收訊息）
├── /lib/
│   ├── firebase.js        // Firebase 連線設定（共用）
│   └── line.js            // LINE API 共用功能（例如送訊息）
├── /public/               // 圖片、靜態檔案
└── package.json           // 專案設定
```

## 頁面

### 前台

- **日期和時間選擇器**：供用戶選擇預約時段
- **輸入表單**：收集用戶姓名和聯絡方式等資訊
    - 姓名欄位會自動填入用戶的 LINE 顯示名稱
    - 聯絡方式由用戶手動輸入
- **確認頁面**：讓用戶檢視並提交預約詳情
    - 顯示用戶選擇的日期、時間、姓名和聯絡方式
    - 提交後，資料會發送到後端（未來存到資料庫），目前會發送到 LINE 聊天室（製作成LINE Flex

## 概述

- 這是一個美甲預約頁面，使用者可以透過這個頁面進行預約。
- 利用 LINE Front-end Framework（LIFF）讓使用者可以直接透過 LINE 進行身份驗證，這樣就不需要另外處理登入流程。
- 美甲師可以透過後台管理預約和可預約時段。
- 未來計畫支援行銷活動和集點功能，因此需要資料庫來儲存會員資料。

## 環境

- **前端**：Next.js
    - 用於構建客戶預約頁面和美甲師後台頁面，支援 LIFF 運行。
- **後端**：Next.js API Routes（使用 JavaScript）
    - 處理 LINE Bot 的 Webhook（接收用戶訊息並動態回應 Quick Reply 按鈕）。
    - 處理預約資料的存取（與 Firebase 整合）。
- **資料庫**：Firebase Firestore
    - 儲存預約資料、可預約時段，未來用於儲存會員資料（點數、推薦紀錄等）。
    - 部署在 Google 雲端，選擇亞洲區域（如 `asia-east1`）以降低延遲。
- **部署**：Vercel
    - 部署前端（LIFF 頁面）和後端（API Routes），提供 HTTPS 網址以符合 LIFF 和 LINE Webhook 要求。
- **框架**：LINE Front-end Framework（LIFF）
    - 用於身份驗證（透過 LINE 登入）和頁面運行（客戶和後台頁面跑在 LINE 裡）。
    - 使用兩個 LIFF ID，分別對應客戶頁面和後台頁面，確保直接載入正確頁面。
- **LINE Bot**：LINE Messaging API
    - 提供 Quick Reply 按鈕，讓用戶快速進入 LIFF 頁面。
    - 根據用戶身份（userId）動態顯示按鈕，客戶看不到「後台」按鈕。

## 頁面

### 前台

- **日期和時間選擇器**：供用戶選擇預約時段。
- **輸入表單**：收集用戶姓名和聯絡方式等資訊。
    - 姓名欄位會自動填入用戶的 LINE 顯示名稱。
    - 聯絡方式由用戶手動輸入。
- **確認頁面**：讓用戶檢視並提交預約詳情。
    - 顯示用戶選擇的日期、時間、姓名和聯絡方式。
    - 提交後，資料會發送到後端（未來存到資料庫），目前會發送到 LINE 聊天室。

### 後台

- **收到「前台」的表單回覆**：
    - 顯示所有預約列表（目前用假資料，未來從資料庫讀取）。
- **修改用戶選擇的預約時段**：
    - 顯示可預約時段列表。
    - 提供「新增時段」功能（目前用輸入框，未來存到資料庫）。
- **存取控制**：
    - 只有美甲師（特定 LINE userId）能進入後台。
    - 如果非美甲師嘗試進入，會顯示錯誤訊息並關閉頁面。

## 注意事項

- LINE Bot 的金鑰（Channel Access Token）不能放在程式碼裡面。
    - 使用環境變數儲存金鑰，在 Vercel 部署時設定。
    - 本地開發時，使用 `.env.local` 檔案儲存金鑰，並確保該檔案不被推送到 GitHub。
- 由於 Vercel 免費方案要求 GitHub 倉庫公開，需確保所有敏感資訊（如金鑰）都透過環境變數管理，避免洩漏。
- 未來若需保護程式碼隱私，可考慮升級 Vercel 付費方案以支援私有倉庫。
- Quick Reply 按鈕會根據用戶身份動態顯示：
    - 客戶（非美甲師）只看到「預約」和「查詢」按鈕。
    - 美甲師（特定 userId）會看到「預約」、「後台」、「查詢」按鈕。
- 使用兩個 LIFF ID：
    - 客戶頁面：綁定 `https://line-nail-bot.vercel.app`。
    - 後台頁面：綁定 `https://line-nail-bot.vercel.app/dashboard`。
    - 確保 Quick Reply 按鈕能直接載入正確頁面，提升用戶體驗。